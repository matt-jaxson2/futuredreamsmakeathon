(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();class y{async fetchData(e,s,o={}){const t=localStorage.getItem(s);if(t)return JSON.parse(t);try{const a=await(await fetch(`${e}`,{...o})).json();return localStorage.setItem(s,JSON.stringify(a)),a}catch(n){console.error("MakeathonAPI Error:",n)}}}class w{constructor(){this.setElements(),this.setEvents()}setElements(){this.elements={body:document.querySelector("body"),modal:document.querySelector(".js-modal"),content:document.querySelector(".js-modal__content"),closeButton:document.querySelector(".js-modal__close")}}setEvents(){document.addEventListener("mouseup",e=>{!this.elements.modal.contains(e.target)&&!e.target.className.includes("image-grid__item")&&this.closeModal()}),this.elements.closeButton.addEventListener("click",e=>{e.preventDefault(),this.closeModal()})}setContent(e){this.elements.content.innerHTML!==e&&(this.elements.content.innerHTML=e)}openModal(){this.elements.body.classList.add("modal-open"),this.elements.modal.setAttribute("aria-hidden",!1),this.elements.closeButton.focus()}closeModal(){this.elements.body.classList.remove("modal-open"),this.elements.modal.setAttribute("aria-hidden",!0)}}const E=()=>window.location.hash.includes("search/"),m=i=>i.replace(/[&<>'"]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[e]);class _{constructor(){this.customRenderEvent=new CustomEvent("grid:rendered")}init(){this.makeathonAPI=new y,this.modal=new w,E()||this.setGrid(),this.setElements(),this.setEvents()}setElements(){this.elements={grid:document.querySelector(".js-image-grid")}}setEvents(){document.addEventListener("grid:rendered",()=>{const e=window.location.hash;if(!e.includes("entry"))return;const s=document.querySelector(`${e}-target`);this.setModalContent(s)}),document.addEventListener("navigation:home",()=>{this.modal.closeModal()}),document.addEventListener("route:entry",()=>{const e=document.querySelector(`${window.location.hash}-target`);e&&this.setModalContent(e)}),this.elements.grid.addEventListener("click",e=>{const s=e.target;s.tagName==="A"&&this.setModalContent(s)})}getRouteId(){return window.location.hash.replace("#entry","")}async setModalContent(e){if(!e)return;const{dataset:{image:s,message:o,name:t}}=e,n=`
      <figure>
        <div class="modal__image-wrapper">
          <img src="${s}" class="modal__image" alt="Photo of ${t}'s knitted flower">
          <div class="content-loader"></div>
        </div>
        <figcaption class="modal__text">
          <p id="modalDescription" class="modal__message">${m(o)}</p>
          <cite class="modal__cite" id="modalLabel">By ${t}</cite>
        </figcaption>
      </figure>
    `;this.modal.setContent(n),this.modal.openModal()}lazyImages(e){const s=new IntersectionObserver(o=>{o.forEach(t=>{if(t.isIntersecting){const n=t.target,{dataset:{alt:a,src:r}}=n;n.src=r,n.alt=a,s.unobserve(n)}})});e.forEach(o=>s.observe(o))}async setGrid(e){const s=e||await this.makeathonAPI.fetchData("entries/data.json","cached:entries"),o=s.length<50?50:s.length;let t="";for(let n=0;n<o;n++){const a=s[n];if(!a)t+=`
          <div class="image-grid__item-wrapper"><div class="image-grid__item image-grid__item--placeholder" aria-hidden="true"></div></div>
        `;else{const{highlight:r,imageSmall:u,imageMedium:g,message:f,name:d,id:p}=a,c=`entry${p}`,v=r?" image-grid__item--highlighted":"",l={small:`https://futuredreamsmakeathon.org.uk/${u}`,medium:`https://futuredreamsmakeathon.org.uk/${g}`};t+=`
          <div class="image-grid__item-wrapper">
            <a id="${c}-target" href="#${c}" class="image-grid__item${v}" data-id="${c}" data-image="${l.medium}" data-name="${d}" data-message="${m(f)}">
              <p class="sr-only">Read the message from ${d}</p>
              <img class="image-grid__image js-lazy-image" data-src="${l.small}" data-alt="Photo of ${d}'s knitted flower" />
            </a>
          </div>
        `}}this.render(t)}renderEvent(){document.dispatchEvent(this.customRenderEvent)}render(e){const s=document.querySelector(".js-image-grid");s.classList.remove("image-grid--loading"),s.innerHTML=e,this.lazyImages(s.querySelectorAll(".js-lazy-image")),this.renderEvent()}}class ${constructor(e){this.routes=e,this.handleRouteChange=this.handleRouteChange.bind(this),window.addEventListener("hashchange",this.handleRouteChange),window.addEventListener("load",this.handleRouteChange),this.handleRouteChange()}handleRouteChange(){const e=window.location.pathname,s=window.location.hash.slice(1);let o;if(e in this.routes&&(o=this.routes[e]),!o&&(o=this.routes[s],!o)){const n=Object.keys(this.routes).filter(a=>a.includes("*"));for(const a of n)if(new RegExp("^"+a.replace("*",".*")+"$").test(s)){o=this.routes[a];break}}const t=this.routes.default;o&&typeof o=="function"?o():t&&typeof t=="function"?t():console.error(`No route found for path/hash: ${e}/${s}`)}}const L=new _;L.init();const h=(i,e={})=>{const s=new CustomEvent(i,{detail:e});document.dispatchEvent(s)};new $({"":()=>{h("navigation:home")},"entry*":()=>{h("route:entry",{route:window.location.hash})}});
